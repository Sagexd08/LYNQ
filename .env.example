# ============================================
# LYNQ - Environment Configuration
# ============================================
# Copy this file to .env in the root directory
# All services (backend, frontend, ML) will read from this single file

# ============================================
# NODE ENVIRONMENT
# ============================================
NODE_ENV=development
# Options: development, production, test

# ============================================
# BACKEND API CONFIGURATION
# ============================================
PORT=3000
# Railway will override this with their PORT

# ============================================
# DATABASE (Supabase PostgreSQL)
# ============================================
# Get from: Supabase â†’ Project Settings â†’ Database â†’ Connection String
# Use "Transaction" mode for production (pgbouncer=true)
DATABASE_URL=postgresql://postgres:password@db.xxxxx.supabase.co:5432/postgres?pgbouncer=true&connection_limit=1

# ============================================
# SUPABASE AUTHENTICATION & API
# ============================================
# Get from: Supabase â†’ Project Settings â†’ API
SUPABASE_URL=https://xxxxx.supabase.co
SUPABASE_ANON_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6...
SUPABASE_SERVICE_KEY=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6...

# ============================================
# JWT AUTHENTICATION
# ============================================
# Generate with: openssl rand -base64 32
# MUST be at least 32 characters
JWT_SECRET=your-super-secure-jwt-secret-minimum-32-characters-long-here

# ============================================
# ML SERVICE (AWS EC2 + API Gateway)
# ============================================
# Your deployed ML service URL (EC2 public IP or API Gateway URL)
ML_SERVICE_URL=https://xxxxx.execute-api.us-east-1.amazonaws.com/prod
# Or for direct EC2: http://ec2-xx-xx-xx-xx.compute-1.amazonaws.com:8000

# ML API Key for authentication (must match ML service API_KEY)
# Generate with: openssl rand -hex 32
ML_API_KEY=your-secure-ml-api-key-matching-ec2-service

# ============================================
# AWS CONFIGURATION (for S3 model storage)
# ============================================
# Already configured on your EC2 instance
AWS_REGION=us-east-1
AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE
AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY

# S3 bucket where ML models are stored
S3_BUCKET=lynq-ml-models
S3_KEY=models/credit_model_v1.pkl

# ============================================
# REDIS (Railway Redis or Local)
# ============================================
# Local development:
REDIS_URL=redis://localhost:6379
# Railway Redis (add Railway Redis service):
# REDIS_URL=redis://default:password@monorail.proxy.rlwy.net:12345

# ============================================
# BLOCKCHAIN - MANTLE SEPOLIA TESTNET (PRIMARY)
# ============================================
# Mantle Sepolia RPC URL
MANTLE_SEPOLIA_RPC_URL=https://rpc.sepolia.mantle.xyz
# Alternative public RPC: https://rpc-sepolia.mantlelabs.io

# Mantle Explorer API Key (optional, for contract verification)
MANTLE_EXPLORER_API_KEY=your_mantle_explorer_api_key

# ============================================
# BLOCKCHAIN - ETHEREUM SEPOLIA (BACKUP)
# ============================================
# Get RPC URL from: Infura, Alchemy, or QuickNode
BLOCKCHAIN_RPC_URL=https://sepolia.infura.io/v3/YOUR_INFURA_PROJECT_ID
SEPOLIA_RPC_URL=https://sepolia.infura.io/v3/YOUR_INFURA_PROJECT_ID

# ============================================
# BLOCKCHAIN - POLYGON AMOY TESTNET (BACKUP)
# ============================================
BLOCKCHAIN_RPC_URL_POLYGON=https://polygon-amoy.infura.io/v3/YOUR_INFURA_PROJECT_ID
POLYGON_RPC_URL=https://polygon-amoy.infura.io/v3/YOUR_INFURA_PROJECT_ID

# ============================================
# BLOCKCHAIN - WALLET & CONTRACTS
# ============================================
# Deployer wallet private key (without 0x prefix)
# âš ï¸ CRITICAL: NEVER commit actual keys! Use testnet keys only!
PRIVATE_KEY=your_ethereum_private_key_here_without_0x_prefix

# Deployed smart contract addresses (on active network)
LOAN_CORE_ADDRESS=0xYOUR_DEPLOYED_LOAN_CORE_CONTRACT_ADDRESS
COLLATERAL_VAULT_ADDRESS=0xYOUR_COLLATERAL_VAULT_CONTRACT_ADDRESS

# Legacy contract names (for backward compatibility)
LOAN_PLATFORM_ADDRESS=0xYOUR_DEPLOYED_LOAN_CONTRACT_ADDRESS
COLLATERAL_MANAGER_ADDRESS=0xYOUR_COLLATERAL_CONTRACT_ADDRESS

# ============================================
# TELEGRAM BOT
# ============================================
# Get token from @BotFather on Telegram
TELEGRAM_BOT_TOKEN=123456789:ABCdefGHIjklMNOpqrsTUVwxyz-EXAMPLE

# Webhook URL (use your Railway deployment URL)
TELEGRAM_WEBHOOK_URL=https://your-app-name.railway.app/api/v1/telegram/webhook

# Webhook secret (generate with: openssl rand -hex 32)
TELEGRAM_WEBHOOK_SECRET=your-secure-webhook-secret-min-32-chars-here

# Your Telegram user ID (get from @userinfobot)
TELEGRAM_ADMIN_CHAT_ID=123456789

# ============================================
# FRONTEND CONFIGURATION
# ============================================
# API base URL for frontend
VITE_API_URL=http://localhost:3000/api/v1
# For production: https://your-app.railway.app/api/v1

# Blockchain network for frontend
VITE_CHAIN_ID=5003
# 5003 = Mantle Sepolia, 11155111 = Ethereum Sepolia, 80002 = Polygon Amoy

VITE_RPC_URL=https://rpc.sepolia.mantle.xyz
# For Ethereum: https://sepolia.infura.io/v3/YOUR_INFURA_PROJECT_ID

# Frontend contract addresses
VITE_LOAN_CORE_ADDRESS=0xYOUR_DEPLOYED_LOAN_CORE_CONTRACT_ADDRESS
VITE_COLLATERAL_VAULT_ADDRESS=0xYOUR_COLLATERAL_VAULT_CONTRACT_ADDRESS

# ============================================
# OPTIONAL: FEATURE FLAGS
# ============================================
ENABLE_TELEGRAM_BOT=true
ENABLE_ML_SERVICE=true
ENABLE_BLOCKCHAIN=true

# ============================================
# OPTIONAL: CORS CONFIGURATION
# ============================================
# Comma-separated list of allowed origins
CORS_ORIGINS=http://localhost:5173,http://localhost:3000,https://your-frontend.vercel.app

# ============================================
# OPTIONAL: RATE LIMITING
# ============================================
THROTTLE_TTL=60000
# Time window in milliseconds (60000 = 1 minute)

THROTTLE_LIMIT=100
# Max requests per time window

# ============================================
# OPTIONAL: LOGGING
# ============================================
LOG_LEVEL=info
# Options: error, warn, info, debug, verbose

# ============================================
# NOTES FOR MANTLE DEPLOYMENT
# ============================================
# 1. Mantle Sepolia is the PRIMARY testnet for LYNQ
# 2. ChainID: 5003
# 3. Native Token: MNT (test MNT from https://faucet.sepolia.mantle.xyz)
# 4. Block Explorer: https://explorer.sepolia.mantle.xyz
# 5. RPC Endpoints:
#    - Public: https://rpc.sepolia.mantle.xyz
#    - Alternative: https://rpc-sepolia.mantlelabs.io
# 6. Deploy contracts with: npx hardhat run scripts/deploy.ts --network mantleSepolia
# 7. Verify contracts with: npx hardhat verify --network mantleSepolia <address>

# ============================================
# NOTES FOR RAILWAY DEPLOYMENT
# ============================================
# 1. Set Railway "Root Directory" to: backend
# 2. Add all these variables in Railway dashboard
# 3. Railway will auto-set PORT variable
# 4. Add Railway Redis service and copy REDIS_URL
# 5. Use Supabase DATABASE_URL (not Railway Postgres)
# 6. ML_SERVICE_URL should point to your AWS EC2/API Gateway
# 7. Models are already on S3 and EC2 is configured
# 8. Set MANTLE_SEPOLIA_RPC_URL for Mantle network support
NODE_ENV=development

DB_HOST=localhost
DB_PORT=5432
DB_USER=postgres
DB_PASSWORD=postgres
DB_NAME=lynq

JWT_SECRET=change-this-in-production-super-secret-key

EVM_RPC_URL=https://eth-mainnet.g.alchemy.com/v2/YOUR_KEY
POLYGON_RPC_URL=https://polygon-mainnet.g.alchemy.com/v2/YOUR_KEY
BSC_RPC_URL=https://bsc-dataseed.binance.org
APTOS_RPC_URL=https://fullnode.mainnet.aptoslabs.com/v1
FLOW_RPC_URL=https://rest-mainnet.onflow.org

DEPLOYER_PRIVATE_KEY=your-private-key-here

TELEGRAM_BOT_TOKEN=your-telegram-bot-token
EMAIL_API_KEY=your-email-api-key
SMS_API_KEY=your-sms-api-key

UPI_PROVIDER_KEY=your-razorpay-key
UPI_PROVIDER_SECRET=your-razorpay-secret

REDIS_URL=redis://localhost:6379

FRONTEND_URL=http://localhost:3001
BACKEND_URL=http://localhost:3000

AWS_ACCESS_KEY_ID=your-aws-key
AWS_SECRET_ACCESS_KEY=your-aws-secret
AWS_REGION=us-east-1
